"use strict";var v=Object.create;var l=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var R=Object.getOwnPropertyNames;var b=Object.getPrototypeOf,q=Object.prototype.hasOwnProperty;var f=(e,s)=>l(e,"name",{value:s,configurable:!0});var T=(e,s,t,r)=>{if(s&&typeof s=="object"||typeof s=="function")for(let n of R(s))!q.call(e,n)&&n!==t&&l(e,n,{get:()=>s[n],enumerable:!(r=F(s,n))||r.enumerable});return e};var o=(e,s,t)=>(t=e!=null?v(b(e)):{},T(s||!e||!e.__esModule?l(t,"default",{value:e,enumerable:!0}):t,e));var g=o(require("fastify")),p=o(require("@fastify/helmet")),y=o(require("@fastify/compress")),d=o(require("@fastify/cors")),c=o(require("@fastify/caching")),u=require("fs"),h=o(require("path"));var i=(0,g.default)({logger:!1}),a=require("bfj"),C=require("megahash");i.register(p.default,{global:!0}).register(y.default,{global:!0}).register(d.default,{origin:"*"}).register(c.default,{privacy:c.default.privacy.PUBLIC});var m=new C;i.get("/resolve/ens/:ensName",async(e,s)=>{let{ensName:t}=e.params,r=m.get(t);return r?s.send({address:r}):s.send({success:!1})});i.get("/",async(e,s)=>s.send({hello:"world"}));async function S(){console.time("Compiled HashTable"),console.log("Compiling HashTable");let e=a.walk((0,u.createReadStream)(h.default.join(__dirname,"../data/ensToAdd.json")),{encoding:"utf8",flag:"r"}),s="";e.on(a.events.property,t=>{s=t}),e.on(a.events.string,t=>{m.set(s,t)}),e.on(a.events.end,()=>{console.timeEnd("Compiled HashTable"),console.log(m.stats()),console.log("Starting Server"),i.listen({port:parseInt(process.env.PORT)||3002,host:"0.0.0.0"},(t,r)=>{if(!t)console.log("\u{1F680} Server is listening on",r);else throw t})})}f(S,"erecto");S();
