"use strict";var R=Object.create;var c=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var q=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty;var f=(e,s)=>c(e,"name",{value:s,configurable:!0});var C=(e,s,t,r)=>{if(s&&typeof s=="object"||typeof s=="function")for(let a of b(s))!T.call(e,a)&&a!==t&&c(e,a,{get:()=>s[a],enumerable:!(r=v(s,a))||r.enumerable});return e};var n=(e,s,t)=>(t=e!=null?R(q(e)):{},C(s||!e||!e.__esModule?c(t,"default",{value:e,enumerable:!0}):t,e));var g=n(require("fastify")),p=n(require("@fastify/helmet")),y=n(require("@fastify/compress")),d=n(require("@fastify/cors")),m=n(require("@fastify/caching")),u=require("fs"),h=n(require("path"));var o=(0,g.default)({logger:!1}),i=require("bfj"),H=require("megahash");o.register(p.default,{global:!0}).register(y.default,{global:!0}).register(d.default,{origin:"*"}).register(m.default,{privacy:m.default.privacy.PUBLIC});var l=new H,F=!1;o.get("/resolve/ens/:ensName",async(e,s)=>{let{ensName:t}=e.params,r=l.get(t);return r?s.send({address:r}):s.send({success:!1})});o.get("/echo/:st",async(e,s)=>{let{st:t}=e.params;return s.send(t)});o.get("/",async(e,s)=>s.send({...l.stats(),hashTableCompiled:F}));async function I(){o.listen({port:parseInt(process.env.PORT)||3002,host:"0.0.0.0"},(t,r)=>{if(!t)console.log("\u{1F680} Server is listening on",r);else throw t}),console.time("Compiled HashTable"),console.log("Compiling HashTable");let e=i.walk((0,u.createReadStream)(h.default.join(__dirname,"../data/ensToAdd.json")),{encoding:"utf8",flag:"r"}),s="";e.on(i.events.property,t=>{s=t}),e.on(i.events.string,t=>{l.set(s,t)}),e.on(i.events.end,()=>{console.timeEnd("Compiled HashTable"),F=!0,console.log(l.stats())})}f(I,"erecto");I();
